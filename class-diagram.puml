@startuml Vehicle Parking Management System
skinparam classAttributeIconSize 0
skinparam backgroundColor #FFFFFF
skinparam roundCorner 10
skinparam linetype ortho

title Vehicle Parking Management System (Simplified)

' ==================== ENTITY LAYER ====================
package "Entity Layer" #E8F5E9 {
    
    class User {
        - id: Long
        - username: String
        - password: String
        - fullName: String
        - role: Role
        + getId(): Long
        + getRole(): Role
    }
    
    enum Role {
        ADMIN
        EMPLOYEE
    }
    
    class ParkingZone {
        - id: Long
        - name: String
        - vehicleType: VehicleType
        - totalSlots: Integer
        + getSlots(): List<ParkingSlot>
    }
    
    enum VehicleType {
        MOTORBIKE
        CAR
    }
    
    class ParkingSlot {
        - id: Long
        - slotNumber: String
        - status: SlotStatus
        - zone: ParkingZone
        + isAvailable(): boolean
    }
    
    enum SlotStatus {
        AVAILABLE
        OCCUPIED
        MAINTENANCE
    }
    
    class Ticket {
        - id: Long
        - licensePlate: String
        - vehicleType: VehicleType
        - entryTime: LocalDateTime
        - exitTime: LocalDateTime
        - totalAmount: BigDecimal
        - status: TicketStatus
        - slot: ParkingSlot
        + calculateFee(): BigDecimal
    }
    
    enum TicketStatus {
        ACTIVE
        COMPLETED
    }
}

' ==================== DTO LAYER ====================
package "DTO Layer" #F3E5F5 {
    class LoginRequest
    class CreateZoneRequest
    class CreateTicketRequest {
        - licensePlate: String
        - vehicleType: String
        - zoneId: Long
    }
    class CheckoutResponse {
        - ticketId: Long
        - amount: BigDecimal
        - duration: String
    }
}

' ==================== REPOSITORY LAYER ====================
package "Repository Layer" #FFF3E0 {
    interface UserRepository
    interface ParkingZoneRepository
    interface ParkingSlotRepository
    interface TicketRepository
}

' ==================== SERVICE LAYER ====================
package "Service Layer" #E3F2FD {
    
    class UserService {
        + register(RegisterRequest): User
        + login(LoginRequest): String
    }
    
    class ParkingZoneService {
        + createZone(CreateZoneRequest): ParkingZone
        + getAllZones(): List<ParkingZone>
    }
    
    class ParkingSlotService {
        + getAvailableSlots(Long): List<ParkingSlot>
        + updateStatus(Long, SlotStatus): void
    }
    
    class TicketService {
        + createTicket(CreateTicketRequest): Ticket
        + processExit(Long): CheckoutResponse
        - calculateFee(LocalDateTime, LocalDateTime, VehicleType): BigDecimal
    }
    
    class ReportService {
        + getDailyRevenue(LocalDate): Double
    }
}

' ==================== CONTROLLER LAYER ====================
package "Controller Layer" #FCE4EC {
    class AuthController
    class ParkingZoneController
    class TicketController {
        + checkIn(CreateTicketRequest): ResponseEntity
        + checkOut(Long): ResponseEntity
    }
    class ReportController
}

' ==================== RELATIONSHIPS ====================

' --- Entity Logic ---
' Một Zone chứa nhiều Slot (Quan hệ sống còn)
ParkingZone "1" *-- "1..*" ParkingSlot : contains >

' Một Ticket được gán cho một Slot cụ thể
Ticket "0..*" --> "1" ParkingSlot : assigned to >

' Enum relationships
User ..> Role
ParkingZone ..> VehicleType
Ticket ..> VehicleType
ParkingSlot ..> SlotStatus
Ticket ..> TicketStatus

' --- Architecture Logic ---
AuthController ..> UserService
ParkingZoneController ..> ParkingZoneService
ParkingZoneController ..> ParkingSlotService
TicketController ..> TicketService
ReportController ..> ReportService

' Service Dependencies
UserService ..> UserRepository
ParkingZoneService ..> ParkingZoneRepository
ParkingSlotService ..> ParkingSlotRepository
TicketService ..> TicketRepository
TicketService ..> ParkingSlotRepository : check/update slot
ReportService ..> TicketRepository

' Controller uses DTO
TicketController ..> CreateTicketRequest
TicketController ..> CheckoutResponse

@enduml